MAST for IBM DataPower™  2.0.1
MAST Web GUI Manual












MAST for IBM DataPower™  2.0.1
MAST Web GUI Manual
© 2015 McIndi Solutions LLC
All rights reserved
________________


Table of Contents


Table of Contents
Introduction
Running mast-web
mastd
Windows
Linux
mast-web
Configuring mast-web
Getting started
accounts
list groups
add group
del group
list users
add user
del user
change password
force change password
list rbm fallback
add rbm fallback
del rbm fallback
flush aaa cache
flush ldap pool cache
flush rbm cache
Backups
restore normal backup
do normal backup
secure backup
restore secure backup
list checkpoints
remove checkpoint
rollback checkpoint
set checkpoint
Deployment
set file
get file
del file
clean up
predeploy
deploy
postdeploy
Developer
flush document cache
flush stylesheet cache
import
export
Network
check connectivity
tcp connection test
display routing table
display ethernet interface
list host aliases
add host alias
del host alias
list secondary addresses
add secondary address
del secondary address
list static hosts
add static host
del static host
list static routes
add static route
del static route
flush arp cache
flush dns cache
flush nd cache
flush pdp cache
SSH
Status
System
xor
flush aaa cache
flush arp cache
flush dns cache
flush document cache
flush ldap pool cache
flush nd cache
flush nss cache
flush pdp cache
flush rbm cache
flush stylesheet cache
save
quiesce service
unquiesce service
list domains
add domain
del domain
quiesce domain
unquiesce domain
disable domain
enable domain
quiesce appliance
unquiesce appliance
reboot appliance
shutdown appliance
reload appliance
firmware upgrade
get encrypted filesystem
get temporary filesystem
get filestore
copy file
set file
get file
del file
get error reports
copy directory
fetch logs
get pmr info
object audit
get status
get config
clean up
Conclusion
Introduction
Welcome to the MAST Web GUI Manual. In this document we will try to walk you through the important parts of the MAST for IBM DataPower 2.0.1 Web GUI. This interface has been designed to be easy to use and as functional as possible.
Running mast-web
There are two ways to start the MAST Web GUI, through mastd or through mast-web. Both executables are in $MAST_HOME. The process differs between platforms for mastd, but it is the same for mast-web. Below we will describe how to launch each one:
mastd
mastd is the prefered method of hosting mast-web because it can be configured to start on boot. The method for setting this up varies by platform.
Windows
The script mastd.bat can be used to install, start, stop and restart the mastd Windows service. In order to install mastd as a Windows service you can issue the following command:
C:\mast\> mastd.bat install
After issuing this command, you can configure, start, stop and restart just like any other Windows service, but mastd.bat can also be used for the same purpose. There are also a number of parameters which can be provided to mastd.bat install which can configure things like which user to run as or whether to start on boot. Please see the output of mastd.bat install /? for all of your options.
Linux
The script mastd can be used to start, stop, restart and to query the status of the mastd daemon. In order to achieve maximum flexibility in supported Linux distributions and their choice in init systems we have chosen to allow the user to configure mastd as a service through their distribution’s init system. Please consult your Operating System’s documentation on how to do this. If you have any trouble please don’t hesitate to contact us at support@mcindi.com as we have experts in most Linux distributions standing by.
mast-web
as an alternative to mastd, we also have a script which allows you to start MAST Web as a non-privileged user in an ad-hoc manner. The process is the same for Windows or Linux, simply execute $MAST_HOME/mast-web and your Web GUI will be started for you.
Configuring mast-web
Whichever way you choose to start mast-web, the process for configuration is the same. Simply copy $MAST_HOME/etc/default/server.conf to $MAST_HOME/etc/local/server.conf, and edit the copy you just made (It is important to remember to never edit a configuration file in $MAST_HOME/etc/default/ as these files can be overwritten during an upgrade to MAST). There is documentation in the configuration file for what each option means, but we will cover the most important ones here.
In the [server] stanza, you will find the most important options. The most important options are cert, key and cacert. This is because every copy of MAST for IBM DataPower ships with the same key-pair, so it would trivial for an attacker to decrypt your traffic. Please substitute your own key-pair as soon as MAST is installed.
The next important option is host, as this configures which address mast-web is listening to. By default mast-web is only listening to localhost so no other machines can connect. In order to allow any machine to connect change this to 0.0.0.0.
You may also wish to change the port to a privileged port such as 443 in order for your users to be able to type a friendly address into the address bar of their browser. For instance if you change port to 443 you can type https://mast-server into the address bar (substitute mast-server for the actual hostname or ip address of the server).
Getting started
The first thing we should note is that we have made the decision to offload RBM and access controls to the investment you have made into these areas on your datapower appliances. Because of this anyone who can connect to MAST Web will not be prompted to log in, but rather they will need to provide credentials for each of the appliances they would like to connect to. That being said, when you load the MAST Web GUI in the browser you will be greeted with a screen which looks like this:
________________


 Screenshot_1.png 

1. Hostname/Environment - In this box, you can enter the hostname or ip address of an appliance as well as an alias configured in hosts.conf or the name of an environment configured in environments.conf.
2. Username - This is the username you will use to authenticate to the appliance(s) you are connecting to.
3. Password - This is the password for the username you entered in box 2.
4. no_check_hostname - Check this box if the certificate presented by the appliance(s) will not be trusted by your system for instance if it is self-signed.
5. Add - Click this button to add the appliance(s) to the list of connected appliances.
6. Appliances - This is a list of currently connected appliances. If the background color shows up as red then there was an error connecting to the xml management interface, if it’s yellow then there was a problem connecting to the appliance via ssh. There is also a checkbox for each appliance, if you’d like to exclude that particular appliance from any action simply uncheck the box.
So there are a few steps to working with MAST Web, and the first is to add appliances by supplying the hostname, username, password and clicking “Add”. Once you have a list of appliances built, you can start interacting with them. There are a number of tabs each one focusing on a different area of functionality.
1. accounts
2. backups
3. deployment
4. developer
5. network
6. ssh
7. status
8. system
We will go over each one individually.
accounts
This tab provides functionality related to user groups, user accounts and RBM settings. Each of the buttons in the left-most pane provides a single piece of functionality. When you click one, a form will be presented in the center pane, and when you fill out that form and click submit the results will be presented in the right-most pane. We will briefly review each button and it’s purpose:
list groups
This command will list the groups present on each appliance as well as the groups common to all appliances.
add group
This command will add a user group to the appliances.


IMPORTANT: The functionality to add access-policies to the user group being created is currently broken. It will only accept one access policy. We are working to find an acceptable solution to the problem.
del group
This command will delete a user group from the appliances.
list users
This command lists the local users on the appliances as well as the users common to all appliances
add user
This command will add a user to the appliances.
del user
This command will delete a user from the appliances.
change password
This command will change a local user’s password on the appliances.
force change password
This command will force a local user to change their password during the next login on the appliances.
list rbm fallback
This command will list RBM fallback users on the appliances.
add rbm fallback
This command will add a user to the RBM fallback users of the appliances.
del rbm fallback
This command will remove a user from the RBM fallback users of the appliances.
flush aaa cache
This command will flush the AAA cache on the appliances.
flush ldap pool cache
This command will flush the LDAP Pool cache on the appliances.
flush rbm cache
This command will flush the RBM cache on the appliances.


Please see the help menu for each of these commands (by passing the “-h” flag on the command line) for what information needs to be provided for the subcommands.
Backups
This  tab groups functionality related to checkpoints, normal backups and secure backups. Each of the buttons in the left-most pane provides a single piece of functionality. When you click one, a form will be presented in the center pane, and when you fill out that form and click submit the results will be presented in the right-most pane. We will briefly review each button and it’s purpose:
restore normal backup
This command will Restore a normal backup to the specified domains on the appliances.
do normal backup
This command performs a normal backup of the specified domain(s) on the appliances.
secure backup
This command will perform a secure backup of the appliances.
restore secure backup
This command will Restore a secure backup to specified appliances.
list checkpoints
This command will List the checkpoints which are currently in the specified domain on the appliances.
remove checkpoint
This command will Delete a checkpoint from the specified domain on the appliances.
rollback checkpoint
This command will roll back the specified domain to the named checkpoint on the appliances.
set checkpoint
This command will Set a checkpoint in the given domain(s) on the appliances.
Deployment
This tab groups functionality related to deploying applications in accordance with best practices as well as some related functionality. Each of the buttons in the left-most pane provides a single piece of functionality. When you click one, a form will be presented in the center pane, and when you fill out that form and click submit the results will be presented in the right-most pane. We will briefly review each button and it’s purpose:
set file
This command will Upload a file to the specified destination on the appliances.
get file
This command will download a file from the specified appliances.
del file
This command will delete the specified file from the appliances.
clean up
This command will clean up the specified appliances temporary filesystem.
predeploy
This command is used to perform routine pre-deployment actions. Everything is optional, but if you wish to perform an action, you must provide the necessary arguments.
deploy
This command is used to perform a deployment/migration of a service/object to an IBM DataPower appliance. This script will try to perform the deployment/migration in a manner consistent with best practices.
postdeploy
This command will allow you to unquiesce your domain or appliances after you quiesce them for a deployment. Also this will allow you to save the config.
Developer
This tab groups functionality related to the development of objects and services for IBM Datapower appliances. Each of the buttons in the left-most pane provides a single piece of functionality. When you click one, a form will be presented in the center pane, and when you fill out that form and click submit the results will be presented in the right-most pane. We will briefly review each button and it’s purpose:
flush document cache
This command will flush the Document Cache for the specified xml_manager in the specified domain on the applianes.
flush stylesheet cache
This command will flush the Stylesheet Cache for the specified xml_manager in the specified domain on the appliances.
import
This command will import a service/object into the specified domain on the appliances.
export
This command will Export a service or object from the specified domain on the appliances.
Network
This tab groups functionality which allows you to view, edit, create and delete network related configuration. Each of the buttons in the left-most pane provides a single piece of functionality. When you click one, a form will be presented in the center pane, and when you fill out that form and click submit the results will be presented in the right-most pane. We will briefly review each button and it’s purpose:
check connectivity
This command will check the connectivity of the three mgmt interfaces (xml, web and cli) on the specified appliances.
tcp connection test
This command will perform a TCP Connection Test from each appliance to each remote_host at each remote_port.
display routing table
This command will display the routing table for the specified appliances
display ethernet interface
This command will display the details of the specified ethernet interface on the specified appliances.
list host aliases
This command will list the host aliases of the specified appliances as well as the host aliases common to all specified appliances.
add host alias
This command will Add a host alias to the specified appliances.
del host alias
This command will remove a host alias from the specified appliances.
list secondary addresses
This command will list the secondary IP Addresses on the specified Ethernet Interface for the specified appliances.
add secondary address
This command will add a secondary IP address to the specified appliances on the specified ethernet interface.
del secondary address
This command will remove a secondary IP address from the specified appliances on the specified ethernet interface
list static hosts
This command will list the static hosts on the specified appliances.
add static host
This command will add a static host to  the specified appliances.
del static host
This command will remove a static host from the specified appliances.
list static routes
This command will list all of the static routes on the specified ethernet interface on the specified appliances.
add static route
This command will add a static route to the specified appliance on the specified ethernet interface.
del static route
This command will removes a static route from the specified appliance on the specified ethernet interface.
flush arp cache
This command will flush the ARP Cache on the specified appliances.
flush dns cache
This command will flush the DNS Cache for the specified appliances.
flush nd cache
This command will flush the ND cache on the specified appliances.
flush pdp cache
This command will flush the PDP cache on the specified appliances for the specified XACMLPDP.
SSH
This tab is different from the others, instead of a group of buttons, it provides a single text input which will accept a cli command to be issued to each appliance you are connected to. If you wish to exclude an appliance when issuing a command, simply uncheck the checkbox next to that appliance’s hostname at the top of the page.
Status
This tab is also different from the rest of the tabs. There is a start/stop button at the top of the tab which when clicked will start real-time monitoring of the appliances you have checked up at the top of the page. Under the start/stop button, there is a link which when clicked will allow you to select additional metrics to monitor.
It is a good idea to stop the monitoring before changing the metrics you are watching or the appliances you have selected.
System
This tab groups functionality related to system administration and operations. Each of the buttons in the left-most pane provides a single piece of functionality. When you click one, a form will be presented in the center pane, and when you fill out that form and click submit the results will be presented in the right-most pane. We will briefly review each button and it’s purpose:
xor
This will xor encode and base64 encode the given string suitable for use in passing credentials to MAST CLI commands. This is a useful utility for scripting multiple MAST CLI commands since your credentials will not be in plain text.
flush aaa cache
This command will flush the AAA Cache for the specified AAAPolicy in the specified Domain on the specified appliances.
flush arp cache
This command will flush the ARP cache on the specified appliances.
flush dns cache
This command will flush the DNS cache on the specified appliances.
flush document cache
This will flush the document cache for the specified xml_manager in the specified domain on the specified appliances.
flush ldap pool cache
This command will flush the LDAP Pool Cache for the specified xml_manager in the specified domain on the specified appliances
flush nd cache
This command will flush the ND cache for the specified appliances.
flush nss cache
This will flush the NSS cache for the specified ZOSNSSClient in the specified domain for the specified appliances.
flush pdp cache
This command will flush the PDP cache for the specified XACML_PDP for the specified appliances.
flush rbm cache
This command will flush the RBM cache in the specified domain for the specified appliances.
flush stylesheet cache
This command will flush the stylesheet cache for the specified xml_manager in the specified Domain on the specified appliances.
save
This command will save the configuration in the given domain(s) on the appliances.
quiesce service
This command will quiesce a service in the specified domain on the specified appliances.
unquiesce service
This command will unquiesce a service in the specified domain on the specified appliances.
list domains
This command will List the domains on the specified appliances as well as domains common to all appliances.
add domain
This command will add a domain to the specified appliances.
del domain
This command will remove a domain from the specified appliances
quiesce domain
This command will quiesce a domain on the specified appliances
unquiesce domain
This command will unquiesce a domain on the specified appliances
disable domain
This command will disable a domain on the specified appliances.
enable domain
This command will enable a domain on the specified appliances.
quiesce appliance
This command will quiesce the specified appliances.
unquiesce appliance
This command will quiesce the specified appliances.
reboot appliance
This command will reboot the specified appliances
shutdown appliance
This command will shutdown the specified appliances
reload appliance
This command will quiesce the specified appliances.
firmware upgrade
This command will attempt to upgrade the firmware of the specified appliances.
get encrypted filesystem
This command will get a directory listing of all locations within the encrypted filesystem.
get temporary filesystem
This command will get a directory listing of all locations within the temporary filesystem.
get filestore
This command will get the directory listing of the specified location.
copy file
This command will Copy a file from src to dst (both src and dst are on the appliance) optionally overwriting dst.
set file
This command will upload a file to the specified appliances.
get file
This command will upload a file to the specified appliances.
del file
This command will delete a file from the appliances.
get error reports
This command will attempt to retrieve any error reports from the currently configured location on the DataPower appliances.
copy directory
This command will get all of the files from a directory on the appliances in the specified domain.
fetch logs
This command will fetch all log files from the specified appliances
get pmr info
This command will get all possible troubleshooting information from the specified appliances.
object audit
This command will get a "diff" of the current and persisted configuration
get status
This command will query the status of the specified appliances in in the specified Domain for the specified status providers.
get config
This command will get the config of obj_name from the specified domain on the specified appliances.
clean up
This command will clean up the specified appliances temporary filesystem.
Troubleshooting
If you have issues in the ssh tab or the status tab, your best resource is the files in $MAST_HOME/var/log/, but for any other tab more information is provided in the GUI itself. When the output is displayed after clicking the “Submit” button on one of the forms there is a link near the top of the output which normally will allow you to download a request/response history  between MAST and the appliances, but in the event of an unhandled exception, this will be a traceback which can be very valuable in troubleshooting (even if you are not comfortable reviewing tracebacks, it will assist in diagnosing problems when submitting an issue to mcindi support).
Conclusion
In this manual we covered the basics of interacting with the MAST Web GUI and went through the functionality provided by each tab. Hopefully, you have learned enough to get you started using the MAST Web GUI effectively.
If you have any problems, questions or concerns please contact us at support@mcindi.com.
















NOTICE: IBM DataPower and the WebSphere product line is the Intellectual Property of International Business Machines Corporation.
________________
© 2015 McIndi Solutions LLC
All rights reserved